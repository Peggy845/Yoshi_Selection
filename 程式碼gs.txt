function doGet() {
  const ss = SpreadsheetApp.openById("1KXmggPfKqpg5gZCsUujlpdTcKSFdGJHv4bOux3nc2xo");
  
  // 讀分類圖片
  const sheetCat = ss.getSheetByName("分類圖片");
  const catData = sheetCat.getDataRange().getValues();
  const catHeaders = catData.shift();
  
  const categoryImages = catData.map(row => {
    let obj = {};
    catHeaders.forEach((h, i) => obj[h] = row[i]);
    return obj;
  });
  
  return ContentService.createTextOutput(JSON.stringify({ categoryImages }))
    .setMimeType(ContentService.MimeType.JSON);
}